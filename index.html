<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ho√†n Th√†nh V∆∞·ª£t Link</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            text-align: center;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 90%;
        }
        h1 {
            color: #1877f2;
            font-size: 24px;
            margin-bottom: 10px;
        }
        p {
            color: #606770;
            margin-bottom: 25px;
            font-size: 16px;
        }
        #claim-button {
            background-color: #42b72a; /* M√†u xanh l√° c√¢y */
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            width: 100%;
        }
        #claim-button:hover:not(:disabled) {
            background-color: #36a420;
        }
        #claim-button:disabled {
            background-color: #a8a8a8;
            cursor: not-allowed;
        }
        #status {
            margin-top: 20px;
            font-weight: bold;
            min-height: 20px;
        }
        .success {
            color: #42b72a;
        }
        .error {
            color: #fa383e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéâ Ho√†n T·∫•t V∆∞·ª£t Link</h1>
        <p>B·∫•m v√†o n√∫t b√™n d∆∞·ªõi ƒë·ªÉ x√°c nh·∫≠n v√† nh·∫≠n Coin v√†o t√†i kho·∫£n Discord c·ªßa b·∫°n.</p>
        
        <button id="claim-button">Nh·∫≠n Coin Ngay</button>
        
        <div id="status"></div>
    </div>

    <script>
        document.getElementById('claim-button').addEventListener('click', async function() {
            const button = this;
            const statusDiv = document.getElementById('status');
            
            // L·∫•y c√°c tham s·ªë t·ª´ URL
            const urlParams = new URLSearchParams(window.location.search);
            const userId = urlParams.get('user_id');
            const amount = urlParams.get('amount');
            const uuid = urlParams.get('uuid');
            const apiUrl = urlParams.get('api'); // L·∫•y API endpoint t·ª´ tham s·ªë URL

            // Ki·ªÉm tra c√°c tham s·ªë c·∫ßn thi·∫øt
            if (!userId || !amount || !uuid || !apiUrl) {
                statusDiv.className = 'error';
                statusDiv.textContent = '‚ùå L·ªói: Thi·∫øu th√¥ng tin c·∫ßn thi·∫øt trong URL.';
                return;
            }

            // X√¢y d·ª±ng URL API ho√†n ch·ªânh
            const fullApiUrl = `${apiUrl}?user_id=${userId}&amount=${amount}&uuid=${uuid}`;

            button.disabled = true;
            button.textContent = 'ƒêang x·ª≠ l√Ω...';
            statusDiv.textContent = 'ƒêang g·ª≠i y√™u c·∫ßu ƒë·∫øn Bot...';
            statusDiv.className = '';

            try {
                // G·ª≠i y√™u c·∫ßu API ƒë·∫øn Bot Backend
                const response = await fetch(fullApiUrl);
                const responseText = await response.text();

                if (response.ok) {
                    statusDiv.className = 'success';
                    statusDiv.textContent = `‚úÖ Th√†nh c√¥ng: ${responseText}`;
                    button.textContent = 'ƒê√£ Nh·∫≠n Coin';
                } else {
                    statusDiv.className = 'error';
                    // Hi·ªÉn th·ªã chi ti·∫øt l·ªói t·ª´ API Bot (n·∫øu c√≥, v√≠ d·ª•: "M√£ y√™u c·∫ßu kh√¥ng h·ª£p l·ªá")
                    statusDiv.textContent = `‚ùå L·ªói API: ${responseText}`; 
                    button.disabled = false;
                    button.textContent = 'Th·ª≠ l·∫°i';
                }
            } catch (error) {
                // B·∫Øt l·ªói k·∫øt n·ªëi (v√≠ d·ª•: L·ªói Mixed Content, L·ªói m·∫°ng)
                statusDiv.className = 'error';
                statusDiv.textContent = '‚ö†Ô∏è L·ªói K·∫øt N·ªëi. Ki·ªÉm tra T∆∞·ªùng l·ª≠a/Giao th·ª©c HTTP/HTTPS (Mixed Content).';
                button.disabled = false;
                button.textContent = 'Th·ª≠ l·∫°i';
                console.error('L·ªói k·∫øt n·ªëi API Bot:', error);
            }
        });

        // T·ª± ƒë·ªông ki·ªÉm tra l·ªói khi t·∫£i trang (N·∫øu kh√¥ng c√≥ l·ªói console, JS v·∫´n ho·∫°t ƒë·ªông)
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (!urlParams.get('user_id') || !urlParams.get('amount') || !urlParams.get('uuid') || !urlParams.get('api')) {
                document.getElementById('status').textContent = '‚ö†Ô∏è URL thi·∫øu tham s·ªë. Kh√¥ng th·ªÉ nh·∫≠n Coin.';
                document.getElementById('status').className = 'error';
                document.getElementById('claim-button').disabled = true;
            }
        });
    </script>
</body>
</html>
